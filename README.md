# hydrogen_station_kr
수소유통전담기관에서 제공하는 API 중 다음을 이용하여 HomeAssistant에 원하는 수소충전소의 현재 상태를 센서로 추가하여 볼 수 있습니다.

1. 충전소 운영정보 목록조회
2. 충전소 실시간정보 목록조회

## 사용방법
1. 수소유통전담기관 홈페이지 가입 후 상기 API 사용신청 [(사용신청하기)](https://www.h2nbiz.or.kr/sym/mnu/mpm/EgovMainMenuIndex.do?menuNo=50700&chkURL=/rt/uif/api/informationUse.do)
2. HACS 설치 후 본 github를 Custom Repositories에 추가
3. HA 재부팅 후 통합구성요소 설치 > 하잉 또는 수소유통정보시스템에서 확인되는 정확한 수소충전소명과 위에서 발급받은 API 인증키 입력

## 확인가능정보
아래의 정보가 확인 가능하며, 괄호 안은 출처 API에 해당

![image](https://github.com/user-attachments/assets/6b8455e8-a78b-4f55-90ed-e6f9e0da4a77)

1. 충전소 관리번호 (센서 등록시 이 관리번호로 자동등록)
2. 충전소 POS상태 (실시간)
3. 충전소 운영상태 (실시간)
4. 충전소 대기차량수 (실시간)
5. 충전소 혼잡상태 (실시간)
6. 운영상태갱신일자 (실시간)
7. 판매가격 (운영)
8. 이용가능요일 (운영)
9. 예약가능여부 (운영)
10. 운영시간(월~일, 공휴일, 운영)

## 변경이력

|일자|버전|설명|
|------|---|---|
|2024-08-15|v1.0.1-240815|api.py와 sensor.py 분리|
|2024-08-15|v1.0.0-240815|정식 개시 (이전 수정사항은 커밋 이력 참고 바람)|

## FAQ
- POS상태와 운영상태를 모두 보는 이유?

영업시간이 지나도 운영상태의 소스가 되는 기계가 꺼져도 POS는 꺼지지 않는 경우가 있는 것으로 파악됨. 그래서 POS상태만 볼 경우, 영업시간이 지나도 운영중으로 나오는 경우가 많음. 그런데 운영시간 중 잠깐의 기계결함으로 운영이 멈췄을때, 운영상태의 소스가 되는 기계는 꺼둔 상태에서 POS는 운영하며 계속 충전이 되는 경우도 있음. 실제 재고소진, 설비고장 등의 경우 충전소 현장에서 운영상태 뿐만 아니라 POS상태까지 변경하고 있으므로 둘 다 봐야함.
이에 따라 영업시간이 지날 경우 운영상태를 보고 '영업마감' 상태를 띄우고, 운영시간 중에는 POS상태를 보도록 설계. POS상태가 '운영중'인 경우, 센서에 혼잡도(여유/보통/혼잡)을 나타내도록 하고 만약 POS상태가 '운영중'이 아니라 '재고소진'등 다른 상태인 경우 이 상태가 나타나도록 설계함.

